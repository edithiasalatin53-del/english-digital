<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Guru SMP - Om Guru</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        :root {
            --primary: #e85d4c;
            --primary-soft: rgba(232, 93, 76, 0.15);
            --primary-glow: rgba(232, 93, 76, 0.35);
            --secondary: #4a9f7e;
            --accent: #f4a261;
            --bg-deep: #0d0f14;
            --bg-surface: #151820;
            --bg-card: #1a1e28;
            --bg-elevated: #21262f;
            --text-main: #f0f2f5;
            --text-muted: #8b919d;
            --text-dim: #5a6070;
            --border: rgba(255, 255, 255, 0.06);
            --border-light: rgba(255, 255, 255, 0.12);
            --success: #4ade80;
            --danger: #f87171;
            --warning: #fbbf24;
            --info: #60a5fa;
            --bolos: #c084fc;
            --radius-sm: 10px;
            --radius: 16px;
            --radius-lg: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }
        
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-deep);
            color: var(--text-main);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Background System */
        .bg-system {
            position: fixed;
            inset: 0;
            z-index: -1;
            overflow: hidden;
            background: 
                radial-gradient(ellipse 80% 50% at 50% -20%, rgba(232, 93, 76, 0.12), transparent),
                radial-gradient(ellipse 60% 40% at 80% 100%, rgba(74, 159, 126, 0.08), transparent),
                linear-gradient(180deg, var(--bg-deep) 0%, #0a0c10 100%);
        }

        .bg-grid {
            position: absolute;
            inset: 0;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 60px 60px;
            mask-image: radial-gradient(ellipse 70% 70% at 50% 30%, black, transparent);
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.5;
            will-change: transform;
        }

        .orb-1 {
            width: 500px; height: 500px;
            background: linear-gradient(135deg, var(--primary), #ff8a70);
            top: -15%; left: -10%;
            animation: orbFloat1 25s ease-in-out infinite;
        }

        .orb-2 {
            width: 400px; height: 400px;
            background: linear-gradient(135deg, var(--secondary), #6fcfb5);
            bottom: 10%; right: -5%;
            animation: orbFloat2 30s ease-in-out infinite;
        }

        .orb-3 {
            width: 300px; height: 300px;
            background: var(--accent);
            top: 40%; left: 60%;
            opacity: 0.3;
            animation: orbFloat3 20s ease-in-out infinite;
        }

        @keyframes orbFloat1 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(40px, 30px) scale(1.1); }
            66% { transform: translate(-20px, -20px) scale(0.95); }
        }
        @keyframes orbFloat2 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-50px, -30px) scale(1.05); }
        }
        @keyframes orbFloat3 {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-30px, 40px); }
        }

        #app { display: flex; flex-direction: column; min-height: 100vh; position: relative; z-index: 1; }
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

        /* Header */
        .header-wrapper { position: relative; padding: 32px 24px 0; max-width: 1440px; margin: 0 auto; width: 100%; }
        .header-card {
            position: relative; background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-elevated) 100%);
            border: 1px solid var(--border-light); border-radius: var(--radius-lg); padding: 32px;
            display: flex; align-items: center; gap: 32px; flex-wrap: wrap; overflow: hidden;
        }
        .header-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); }
        .header-card::after { content: ''; position: absolute; top: -50%; right: -20%; width: 400px; height: 400px; background: radial-gradient(circle, var(--primary-glow), transparent 70%); opacity: 0.3; pointer-events: none; }
        
        .profile-ring { position: relative; flex-shrink: 0; }
        .ring-outer { position: absolute; inset: -8px; border-radius: 50%; border: 2px solid transparent; border-top-color: var(--primary); border-right-color: var(--secondary); animation: ringRotate 8s linear infinite; }
        .ring-inner { position: absolute; inset: -4px; border-radius: 50%; border: 1px solid var(--accent); opacity: 0.5; animation: ringRotate 12s linear infinite reverse; }
        @keyframes ringRotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        .profile-img { width: 90px; height: 90px; border-radius: 50%; object-fit: cover; border: 3px solid var(--bg-elevated); position: relative; z-index: 1; transition: transform 0.4s; }
        .profile-img:hover { transform: scale(1.08); }

        .profile-info { flex: 1; min-width: 200px; position: relative; z-index: 1; }
        .profile-info .greeting { font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 4px; }
        .profile-info h1 { font-family: 'Space Grotesk', sans-serif; font-size: clamp(1.5rem, 4vw, 2.2rem); font-weight: 700; color: var(--text-main); line-height: 1.2; margin-bottom: 8px; }
        .profile-info .role { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: var(--primary-soft); border: 1px solid rgba(232, 93, 76, 0.2); border-radius: 20px; font-size: 0.85rem; color: var(--primary); font-weight: 500; }

        .header-meta { display: flex; flex-direction: column; gap: 12px; align-items: flex-end; position: relative; z-index: 1; }
        .date-badge { background: var(--bg-elevated); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 14px 20px; text-align: right; }
        .date-badge .day { font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 2px; }
        .date-badge .date { font-family: 'Space Grotesk', sans-serif; font-size: 1rem; font-weight: 600; color: var(--accent); }
        .stats-row { display: flex; gap: 20px; }
        .stat-item { text-align: center; }
        .stat-item .value { font-family: 'Space Grotesk', sans-serif; font-size: 1.5rem; font-weight: 700; color: var(--text-main); }
        .stat-item .label { font-size: 0.7rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }

        /* Navigation */
        nav { position: sticky; top: 0; z-index: 100; background: rgba(13, 15, 20, 0.85); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); padding: 0 24px; margin-top: 24px; }
        .nav-content { max-width: 1440px; margin: 0 auto; overflow-x: auto; scrollbar-width: none; }
        .nav-content::-webkit-scrollbar { display: none; }
        .nav-grid { display: flex; gap: 6px; padding: 16px 0; min-width: max-content; }
        .nav-btn { padding: 12px 20px; border: none; border-radius: var(--radius-sm); background: transparent; color: var(--text-muted); cursor: pointer; white-space: nowrap; font-size: 0.9rem; font-weight: 500; font-family: 'DM Sans', sans-serif; transition: all 0.3s; display: flex; align-items: center; gap: 10px; }
        .nav-btn i { font-size: 1.15rem; transition: transform 0.3s; }
        .nav-btn:hover { background: rgba(255,255,255,0.04); color: var(--text-main); }
        .nav-btn:hover i { transform: translateY(-2px); }
        .nav-btn.active { background: var(--primary); color: white; box-shadow: 0 4px 20px var(--primary-glow); }
        .nav-btn.active i { color: white; }

        /* Main Content */
        main { flex: 1; max-width: 1440px; width: 100%; margin: 0 auto; padding: 32px 24px; }
        .section-title { font-family: 'Space Grotesk', sans-serif; font-size: clamp(1.5rem, 3vw, 1.8rem); font-weight: 700; margin-bottom: 28px; color: var(--text-main); display: flex; align-items: center; gap: 14px; }
        .section-title i { color: var(--primary); font-size: 1.6rem; }
        .content-section { display: none; opacity: 0; transform: translateY(15px); }
        .content-section.active { display: block; animation: fadeSlideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Cards */
        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; margin-bottom: 20px; position: relative; overflow: hidden; transition: all 0.3s ease; }
        .card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--border-light), transparent); }
        .card:hover { border-color: var(--border-light); transform: translateY(-2px); }
        .card h3 { color: var(--text-main); font-size: 1.1rem; font-weight: 600; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .card h3 i { color: var(--primary); font-size: 1.2rem; }

        /* Buttons */
        .btn { padding: 12px 22px; border: none; border-radius: var(--radius-sm); cursor: pointer; font-weight: 600; font-size: 0.9rem; font-family: 'DM Sans', sans-serif; transition: all 0.25s; display: inline-flex; align-items: center; gap: 10px; text-decoration: none; }
        .btn:active { transform: scale(0.97); }
        .btn-primary { background: linear-gradient(135deg, var(--primary), #d14535); color: white; box-shadow: 0 4px 15px var(--primary-glow); }
        .btn-primary:hover { box-shadow: 0 6px 25px var(--primary-glow); transform: translateY(-2px); }
        .btn-secondary { background: var(--bg-elevated); color: var(--text-main); border: 1px solid var(--border); }
        .btn-secondary:hover { background: var(--bg-surface); border-color: var(--border-light); }
        .btn-danger { background: rgba(248, 113, 113, 0.1); color: var(--danger); border: 1px solid rgba(248, 113, 113, 0.2); }
        .btn-danger:hover { background: var(--danger); color: white; }

        /* Forms */
        .form-group { margin-bottom: 18px; }
        .form-label { display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 0.85rem; font-weight: 500; }
        .form-input, .form-select, .form-textarea { width: 100%; background: var(--bg-deep); border: 1px solid var(--border); padding: 14px 16px; color: var(--text-main); border-radius: var(--radius-sm); font-family: inherit; font-size: 0.95rem; transition: all 0.25s ease; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-soft); }
        .form-select option { background: var(--bg-elevated); color: var(--text-main); }

        /* Table */
        .table-container { overflow-x: auto; border-radius: var(--radius-sm); border: 1px solid var(--border); background: var(--bg-deep); }
        table { width: 100%; border-collapse: collapse; min-width: 500px; }
        th { text-align: left; padding: 14px 18px; background: rgba(232, 93, 76, 0.05); color: var(--primary); font-weight: 600; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid var(--border); }
        td { padding: 14px 18px; border-bottom: 1px solid var(--border); color: var(--text-main); font-size: 0.9rem; }
        tr:last-child td { border-bottom: none; }
        tr:hover td { background: rgba(255,255,255,0.01); }

        /* Checkbox Grid */
        .jam-checkbox-container { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; }
        .jam-checkbox-label { background: var(--bg-elevated); padding: 8px 14px; border-radius: 8px; cursor: pointer; user-select: none; border: 1px solid var(--border); transition: all 0.2s; }
        .jam-checkbox-label:hover { border-color: var(--border-light); background: var(--bg-surface); }
        .jam-checkbox-label input { display: none; }
        .jam-checkbox-label span { color: var(--text-muted); font-size: 0.85rem; font-weight: 500; }
        .jam-checkbox-label input:checked + span { color: white; font-weight: 600; }
        .jam-checkbox-label:has(input:checked) { background: var(--primary); border-color: var(--primary); box-shadow: 0 2px 10px var(--primary-glow); }

        /* Student List */
        .student-list-container { max-height: 450px; overflow-y: auto; border: 1px solid var(--border); border-radius: var(--radius-sm); background: var(--bg-deep); }
        .student-item { display: flex; align-items: center; justify-content: space-between; gap: 15px; padding: 14px 18px; border-bottom: 1px solid var(--border); transition: background 0.2s; }
        .student-item:last-child { border-bottom: none; }
        .student-item:hover { background: rgba(255,255,255,0.02); }
        .student-item > div:first-child { font-size: 0.95rem; font-weight: 500; color: var(--text-main); flex-grow: 1; }
        .status-group { display: flex; gap: 5px; flex-shrink: 0; }
        .status-btn { width: 34px; height: 34px; border: none; border-radius: 8px; background: var(--bg-elevated); color: var(--text-dim); cursor: pointer; font-weight: 700; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s; border: 1px solid transparent; }
        .status-btn:hover { background: var(--bg-surface); color: var(--text-main); }
        .active-hadir { background: rgba(74, 222, 128, 0.15) !important; color: var(--success) !important; border-color: rgba(74, 222, 128, 0.3) !important; }
        .active-sakit { background: rgba(251, 191, 36, 0.15) !important; color: var(--warning) !important; border-color: rgba(251, 191, 36, 0.3) !important; }
        .active-izin { background: rgba(96, 165, 250, 0.15) !important; color: var(--info) !important; border-color: rgba(96, 165, 250, 0.3) !important; }
        .active-alpa { background: rgba(248, 113, 113, 0.15) !important; color: var(--danger) !important; border-color: rgba(248, 113, 113, 0.3) !important; }
        .active-bolos { background: rgba(192, 132, 252, 0.15) !important; color: var(--bolos) !important; border-color: rgba(192, 132, 252, 0.3) !important; }
        .student-count-footer { text-align: center; padding: 12px; font-size: 0.8rem; color: var(--text-dim); border-top: 1px solid var(--border); background: var(--bg-elevated); }

        /* Grid Layouts */
        .jadwal-grid, .nilai-meta-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; }
        @media (max-width: 768px) { .jadwal-grid, .nilai-meta-grid { grid-template-columns: 1fr; } .header-card { flex-direction: column; text-align: center; gap: 24px; } .header-meta { align-items: center; width: 100%; } .profile-info { text-align: center; } .stats-row { justify-content: center; } }

        /* Bahan Ajar Grid */
        .bahan-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; margin-top: 16px; }
        .bahan-card { background: var(--bg-elevated); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 22px; transition: all 0.3s ease; position: relative; display: flex; flex-direction: column; height: 100%; }
        .bahan-card:hover { border-color: var(--primary); transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.3); }
        .bahan-card h4 { color: var(--text-main); font-size: 1rem; margin-bottom: 10px; padding-right: 30px; line-height: 1.4; }
        .bahan-card p { color: var(--text-muted); font-size: 0.85rem; margin-bottom: 18px; line-height: 1.5; flex-grow: 1; }
        .delete-btn { position: absolute; top: 14px; right: 14px; background: transparent; border: none; color: var(--text-dim); cursor: pointer; font-size: 1.1rem; padding: 4px; border-radius: 4px; transition: all 0.2s; }
        .delete-btn:hover { color: var(--danger); transform: scale(1.15); }

        /* Modal */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.92); display: flex; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(8px); opacity: 0; visibility: hidden; transition: all 0.3s; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-card { background: linear-gradient(145deg, var(--bg-elevated), var(--bg-card)); padding: 36px; border-radius: var(--radius-lg); border: 1px solid var(--border-light); text-align: center; width: 90%; max-width: 400px; transform: translateY(25px) scale(0.96); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5); }
        .modal-overlay.active .modal-card { transform: translateY(0) scale(1); }
        .modal-card h3 { justify-content: center; margin-bottom: 8px; }
        .password-input { text-align: center; font-size: 1.4rem; letter-spacing: 6px; margin: 20px 0; }
        .modal-actions { margin-top: 24px; display: flex; gap: 12px; justify-content: center; }
        .modal-actions .btn { flex: 1; justify-content: center; }

        /* Toast */
        #toast-container { position: fixed; top: 24px; right: 24px; z-index: 2000; display: flex; flex-direction: column; gap: 12px; }
        .toast { min-width: 300px; padding: 16px 20px; border-radius: var(--radius-sm); background: var(--bg-elevated); color: var(--text-main); border-left: 4px solid var(--primary); box-shadow: 0 12px 20px rgba(0, 0, 0, 0.35); display: flex; align-items: center; justify-content: space-between; animation: slideInRight 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .toast.success { border-left-color: var(--success); }
        .toast.error { border-left-color: var(--danger); }
        .toast.info { border-left-color: var(--info); }
        @keyframes slideInRight { from { opacity: 0; transform: translateX(80px); } to { opacity: 1; transform: translateX(0); } }

        .hidden { display: none !important; }
        .tab-nav { display: flex; gap: 10px; margin-bottom: 22px; border-bottom: 1px solid var(--border); padding-bottom: 18px; overflow-x: auto; }

        /* Profile Section */
        .profile-header-card { display: flex; align-items: center; gap: 32px; padding: 36px; flex-wrap: wrap; }
        .profile-avatar { width: 130px; height: 130px; border-radius: 50%; object-fit: cover; border: 4px solid var(--primary); box-shadow: 0 0 40px var(--primary-glow); }
        .profile-header-info h1 { font-family: 'Space Grotesk', sans-serif; font-size: clamp(1.6rem, 3vw, 2rem); margin-bottom: 6px; }
        .profile-header-info p { font-size: 1.05rem; color: var(--text-muted); margin-bottom: 14px; }
        .info-badges { display: flex; gap: 10px; flex-wrap: wrap; }
        .badge { display: inline-flex; align-items: center; gap: 6px; background: var(--bg-elevated); border: 1px solid var(--border); padding: 6px 14px; border-radius: 20px; font-size: 0.85rem; color: var(--text-main); }
        .badge i { color: var(--primary); }
        .edu-timeline { position: relative; padding-left: 28px; border-left: 2px solid var(--border); }
        .edu-item { position: relative; margin-bottom: 28px; }
        .edu-item::before { content: ''; position: absolute; left: -33px; top: 6px; width: 10px; height: 10px; border-radius: 50%; background: var(--primary); box-shadow: 0 0 12px var(--primary-glow); }
        .edu-item h4 { color: var(--primary); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 4px; }
        .edu-item .title { font-size: 1.05rem; font-weight: 600; color: var(--text-main); margin-bottom: 3px; }
        .edu-item .subtitle { font-size: 0.9rem; color: var(--text-muted); }

        /* Print Styles */
        @media print { .bg-system, nav, .no-print, .tab-nav, .btn, .modal-overlay { display: none !important; } body, .card { background: #fff !important; color: #000 !important; border-color: #e2e8f0 !important; box-shadow: none !important; } }
        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) { *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; } }
    </style>
</head>
<body>
    <div class="bg-system">
        <div class="bg-grid"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <div id="app">
        <!-- Header -->
        <div class="header-wrapper no-print">
            <div class="header-card">
                <div class="profile-ring">
                    <div class="ring-outer"></div>
                    <div class="ring-inner"></div>
                    <img src="https://picsum.photos/seed/omguru/200/200.jpg" alt="Profile" class="profile-img">
                </div>
                <div class="profile-info">
                    <div class="greeting">Portal Guru SMP</div>
                    <h1>Om Guru</h1>
                    <div class="role">
                        <i class="ph ph-graduation-cap"></i>
                        Edithia Opasanta Salatin, S.Pd.I.
                    </div>
                </div>
                <div class="header-meta">
                    <div class="date-badge">
                        <div class="day" id="current-day">-</div>
                        <div class="date" id="current-date">-</div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <div class="value">15+</div>
                            <div class="label">Years Exp</div>
                        </div>
                        <div class="stat-item">
                            <div class="value">6</div>
                            <div class="label">Classes</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="no-print">
            <div class="nav-content">
                <div class="nav-grid">
                    <button class="nav-btn active" onclick="showSection('profil', this)"><i class="ph ph-user-circle"></i> Profil</button>
                    <button class="nav-btn" onclick="showSection('jadwal', this)"><i class="ph ph-calendar"></i> Jadwal</button>
                    <button class="nav-btn" onclick="showSection('silabus', this)"><i class="ph ph-book-open"></i> Silabus</button>
                    <button class="nav-btn" onclick="showSection('bahan-ajar', this)"><i class="ph ph-desktop"></i> Bahan Ajar</button>
                    <button class="nav-btn" onclick="showSection('jurnal', this)"><i class="ph ph-journal"></i> Jurnal</button>
                    <button class="nav-btn" onclick="showSection('asesmen', this)"><i class="ph ph-clipboard-text"></i> Asesmen</button>
                    <button class="nav-btn" onclick="showSection('buku-nilai', this)"><i class="ph ph-exam"></i> Buku Nilai</button>
                    <button class="nav-btn" onclick="showSection('guru-wali', this)"><i class="ph ph-users-three"></i> Guru Wali</button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main>
            <!-- Profil Section -->
            <section id="profil" class="content-section active">
                <div class="section-title"><i class="ph ph-user-circle-dashed"></i> Profil Guru</div>
                <div class="card profile-header-card">
                    <img src="https://picsum.photos/seed/omguru/200/200.jpg" alt="Edithia Opasanta Salatin" class="profile-avatar">
                    <div class="profile-header-info">
                        <h1>Edithia Opasanta Salatin, S.Pd.I.</h1>
                        <p>English Teacher</p>
                        <div class="info-badges">
                            <span class="badge"><i class="ph ph-graduation-cap"></i> UPTD SMP Negeri 6 Metro</span>
                            <span class="badge"><i class="ph ph-map-pin"></i> Metro City, Lampung</span>
                            <span class="badge"><i class="ph ph-clock"></i> 15+ Years Experience</span>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3><i class="ph ph-chat-circle-text"></i> About Me</h3>
                    <p style="color: var(--text-muted); line-height: 1.8;">I am Edithia Opasanta Salatin, S.Pd.I., an educator born and raised in Metro City. With my dedication to teaching English, I have a vision to build quality education in my homeland through communicative and character-based language teaching.</p>
                </div>
                <div class="card">
                    <h3><i class="ph ph-graduation-cap"></i> Educational Background</h3>
                    <div class="edu-timeline">
                        <div class="edu-item">
                            <h4>S1</h4>
                            <div class="title">Bachelor of English Education</div>
                            <div class="subtitle">STAIN Jurai Siwo Metro</div>
                        </div>
                        <div class="edu-item">
                            <h4>SMA</h4>
                            <div class="title">SMA Negeri 3 Metro</div>
                            <div class="subtitle">Metro City</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Jadwal Section -->
            <section id="jadwal" class="content-section">
                <div class="section-title"><i class="ph ph-calendar-check"></i> Jadwal Mengajar</div>
                <div class="card no-print">
                    <button class="btn btn-primary" onclick="openJadwalForm()"><i class="ph ph-lock-key"></i> Buka Form Tambah Jadwal</button>
                </div>
                <div id="jadwal-input-wrapper" class="card hidden">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
                        <h3 style="margin:0;"><i class="ph ph-plus-circle"></i> Tambah Jadwal Baru</h3>
                        <button class="btn btn-secondary" onclick="closeJadwalForm()" style="padding:8px 16px; font-size:0.85rem;">Tutup Form</button>
                    </div>
                    <form id="form-jadwal">
                        <div class="jadwal-grid">
                            <div class="form-group"><label class="form-label">Tahun Pelajaran</label><select id="jadwal-tahun" class="form-select" required></select></div>
                            <div class="form-group"><label class="form-label">Semester</label><select id="jadwal-semester" class="form-select" required><option value="Ganjil">Ganjil</option><option value="Genap">Genap</option></select></div>
                            <div class="form-group"><label class="form-label">Hari</label><select id="jadwal-hari" class="form-select" required><option value="Senin">Senin</option><option value="Selasa">Selasa</option><option value="Rabu">Rabu</option><option value="Kamis">Kamis</option><option value="Jumat">Jumat</option><option value="Sabtu">Sabtu</option></select></div>
                            <div class="form-group" style="grid-column: span 2;"><label class="form-label">Jam Ke</label><div class="jam-checkbox-container" id="jam-jadwal-container"></div></div>
                            <div class="form-group" style="grid-column: span 2;"><label class="form-label">Waktu</label><div id="container-jadwal-waktu" class="jam-checkbox-container"></div></div>
                            <div class="form-group"><label class="form-label">Kelas</label><select id="jadwal-kelas" class="form-select" required><option value="71">71</option><option value="72">72</option><option value="73">73</option><option value="74">74</option><option value="75">75</option><option value="76">76</option></select></div>
                            <div class="form-group"><label class="form-label">Mata Pelajaran</label><select id="jadwal-mapel" class="form-select" required><option value="Bahasa Inggris">Bahasa Inggris</option></select></div>
                        </div>
                        <div style="text-align: right; margin-top: 10px;"><button type="submit" class="btn btn-primary"><i class="ph ph-floppy-disk"></i> Simpan Jadwal</button></div>
                    </form>
                </div>
                <div class="card no-print">
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
                        <label style="color:var(--text-muted); font-size: 0.9rem;">Filter:</label>
                        <select id="tahun-filter" class="form-select" style="width: auto; padding: 10px 14px;"></select>
                        <select id="semester-filter" class="form-select" style="width: auto; padding: 10px 14px;"><option value="Ganjil">Ganjil</option><option value="Genap">Genap</option></select>
                        <button class="btn btn-secondary" onclick="loadScheduleData()"><i class="ph ph-arrows-clockwise"></i></button>
                    </div>
                </div>
                <div id="jadwal-content" class="card"><p style="text-align: center; color: var(--text-muted);">Memuat jadwal...</p></div>
            </section>

            <!-- Silabus Section -->
            <section id="silabus" class="content-section">
                <div class="section-title"><i class="ph ph-book-bookmark"></i> Silabus</div>
                <div class="card">
                    <h3>English for Nusantara</h3>
                    <p style="margin-bottom: 10px; color: var(--text-muted);">Kurikulum Merdeka</p>
                </div>
            </section>

            <!-- Bahan Ajar Section -->
            <section id="bahan-ajar" class="content-section">
                <div class="section-title"><i class="ph ph-desktop"></i> Bahan Ajar</div>
                <div id="password-overlay-bahan" class="modal-overlay">
                    <div class="modal-card">
                        <i class="ph ph-lock-key" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                        <h3>Akses Form Bahan Ajar</h3>
                        <input type="password" id="pw-bahan" class="form-input password-input" placeholder="****">
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeModal('password-overlay-bahan')">Batal</button>
                            <button class="btn btn-primary" onclick="checkPw('pw-bahan', 'password-overlay-bahan')">Buka</button>
                        </div>
                    </div>
                </div>
                <div class="card no-print"><button class="btn btn-primary" onclick="openBahanForm()"><i class="ph ph-lock-key"></i> Buka Form Tambah Bahan</button></div>
                <div id="bahan-form-wrapper" class="card hidden">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
                        <h3 style="margin:0;"><i class="ph ph-plus-circle"></i> Tambah Bahan Ajar Baru</h3>
                        <button class="btn btn-secondary" onclick="closeBahanForm()" style="padding:8px 16px; font-size:0.85rem;">Tutup Form</button>
                    </div>
                    <form id="form-bahan">
                        <div class="form-group"><label class="form-label">Judul Materi</label><input type="text" id="ba-judul" class="form-input" required></div>
                        <div class="form-group"><label class="form-label">Link / URL Materi</label><input type="url" id="ba-link" class="form-input" required></div>
                        <div class="form-group"><label class="form-label">Deskripsi Singkat</label><textarea id="ba-desc" class="form-textarea" rows="2" required></textarea></div>
                        <div style="text-align: right;"><button type="submit" class="btn btn-primary"><i class="ph ph-upload"></i> Simpan</button></div>
                    </form>
                </div>
                <div class="card">
                    <h3><i class="ph ph-books"></i> Daftar Materi Tersimpan</h3>
                    <div id="list-bahan-container" class="bahan-grid"><p style="color:var(--text-muted); grid-column: 1/-1; text-align:center;">Belum ada materi.</p></div>
                </div>
            </section>

            <!-- Jurnal Section -->
            <section id="jurnal" class="content-section">
                <div class="section-title"><i class="ph ph-notebook"></i> Jurnal Kelas & Absensi</div>
                <div class="tab-nav no-print">
                    <button class="nav-btn" onclick="askPasswordForJurnal(this, 'jurnal-input')"><i class="ph ph-pencil-simple"></i> Input Jurnal</button>
                    <button class="nav-btn" onclick="switchTab(this, 'jurnal-rekap')">Rekap Jurnal</button>
                    <button class="nav-btn" onclick="switchTab(this, 'absen-rekap')">Rekap Absen</button>
                </div>
                <div id="password-overlay-jurnal" class="modal-overlay">
                    <div class="modal-card">
                        <i class="ph ph-lock-key" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                        <h3>Akses Input Jurnal</h3>
                        <input type="password" id="pw-jurnal" class="form-input password-input" placeholder="****">
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeModal('password-overlay-jurnal')">Batal</button>
                            <button class="btn btn-primary" onclick="checkPw('pw-jurnal', 'password-overlay-jurnal')">Buka</button>
                        </div>
                    </div>
                </div>
                <div id="jurnal-input" class="tab-pane hidden">
                    <form id="form-jurnal">
                        <div class="card">
                            <h3><i class="ph ph-pencil-simple"></i> Data Jurnal</h3>
                            <div class="jadwal-grid">
                                <div class="form-group"><label class="form-label">Tanggal</label><input type="date" id="j-tanggal" class="form-input" required></div>
                                <div class="form-group"><label class="form-label">Kelas</label><select id="j-kelas" class="form-select" onchange="loadSiswa('j-kelas', 'list-absen')" required><option value="">Pilih Kelas</option><option value="71">71</option><option value="72">72</option><option value="73">73</option><option value="74">74</option><option value="75">75</option><option value="76">76</option></select></div>
                            </div>
                            <div class="form-group"><label class="form-label">Jam Ke</label><div class="jam-checkbox-container" id="jam-jurnal-container"></div></div>
                            <div class="form-group"><label class="form-label">Materi Pokok</label><input type="text" id="j-materi" class="form-input" required></div>
                            <div class="form-group"><label class="form-label">Kegiatan Pembelajaran</label><textarea id="j-kegiatan" class="form-textarea" rows="3" required></textarea></div>
                        </div>
                        <div class="card">
                            <h3><i class="ph ph-users"></i> Absensi Siswa</h3>
                            <div id="list-absen" class="student-list-container"><p style="text-align: center; color: var(--text-muted); padding: 20px;">Pilih kelas.</p></div>
                        </div>
                        <div style="text-align: right;"><button type="submit" id="btn-submit-jurnal" class="btn btn-primary"><i class="ph ph-paper-plane-right"></i> Kirim</button></div>
                    </form>
                </div>
                <div id="jurnal-rekap" class="tab-pane hidden">
                    <div class="card no-print" style="text-align: right;"><button class="btn btn-secondary" onclick="loadRekap('Jurnal', 'rekap-jurnal-body')"><i class="ph ph-arrows-clockwise"></i> Refresh</button></div>
                    <div id="rekap-jurnal-body" class="card"></div>
                </div>
                <div id="absen-rekap" class="tab-pane hidden">
                    <div class="card no-print" style="text-align: right;"><button class="btn btn-secondary" onclick="loadRekap('Absensi', 'rekap-absen-body')"><i class="ph ph-arrows-clockwise"></i> Refresh</button></div>
                    <div id="rekap-absen-body" class="card"><p style="text-align: center; color: var(--text-muted);">Tekan refresh.</p></div>
                </div>
            </section>

            <!-- Asesmen Section -->
            <section id="asesmen" class="content-section">
                <div class="section-title"><i class="ph ph-clipboard-text"></i> Asesmen Pembelajaran</div>
                <div class="card">
                    <h3><i class="ph ph-desktop"></i> Akses CBT</h3>
                    <div style="text-align: center; margin-top: 20px;"><a href="https://edithiasalatin53-del.github.io/Online-Test-System/" target="_blank" class="btn btn-primary"><i class="ph ph-export"></i> Buka Online Test System</a></div>
                </div>
            </section>

            <!-- Buku Nilai Section -->
            <section id="buku-nilai" class="content-section">
                <div class="section-title"><i class="ph ph-exam"></i> Buku Nilai</div>
                <div class="tab-nav no-print">
                    <button class="nav-btn active" onclick="askPasswordForNilai(this, 'nilai-input')"><i class="ph ph-pencil-simple"></i> Input Nilai</button>
                    <button class="nav-btn" onclick="switchTab(this, 'nilai-rekap')">Rekap Nilai</button>
                </div>
                <div id="password-overlay-nilai" class="modal-overlay">
                    <div class="modal-card">
                        <i class="ph ph-lock-key" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                        <h3>Akses Input Nilai</h3>
                        <input type="password" id="pw-nilai" class="form-input password-input" placeholder="****">
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeModal('password-overlay-nilai')">Batal</button>
                            <button class="btn btn-primary" onclick="checkPw('pw-nilai', 'password-overlay-nilai')">Buka</button>
                        </div>
                    </div>
                </div>
                <div id="nilai-input" class="tab-pane hidden">
                    <form id="form-nilai">
                        <div class="card">
                            <h3><i class="ph ph-pencil-simple-line"></i> Metadata</h3>
                            <div class="nilai-meta-grid">
                                <div class="form-group"><label class="form-label">Kelas</label><select id="n-kelas" class="form-select" onchange="loadSiswa('n-kelas', 'list-nilai')" required><option value="">Pilih</option><option value="71">71</option><option value="72">72</option><option value="73">73</option><option value="74">74</option><option value="75">75</option><option value="76">76</option></select></div>
                                <div class="form-group"><label class="form-label">Jenis</label><select id="n-jenis" class="form-select"><option value="Tugas">Tugas</option><option value="UH">UH</option><option value="UTS">UTS</option><option value="UAS">UAS</option></select></div>
                                <div class="form-group"><label class="form-label">Materi</label><input type="text" id="n-materi" class="form-input" required></div>
                                <div class="form-group"><label class="form-label">Tanggal</label><input type="date" id="n-tanggal" class="form-input" required></div>
                            </div>
                        </div>
                        <div class="card">
                            <h3><i class="ph ph-list-numbers"></i> Input Nilai</h3>
                            <div id="list-nilai" class="student-list-container"><p style="text-align: center; padding: 20px; color: var(--text-muted);">Pilih kelas.</p></div>
                        </div>
                        <div style="text-align: right;"><button type="submit" id="btn-submit-nilai" class="btn btn-primary"><i class="ph ph-floppy-disk"></i> Simpan</button></div>
                    </form>
                </div>
                <div id="nilai-rekap" class="tab-pane hidden">
                    <div class="card" id="nilai-login-card">
                        <h3><i class="ph ph-identification-card"></i> Cek Nilai</h3>
                        <div class="form-group"><label class="form-label">NIS</label><input type="number" id="input-nis-siswa" class="form-input" placeholder="NIS"></div>
                        <button class="btn btn-primary" onclick="checkNIS()"><i class="ph ph-magnifying-glass"></i> Cari</button>
                    </div>
                    <div id="nilai-rekap-body" class="card hidden"></div>
                </div>
            </section>
            
            <!-- Guru Wali Section -->
            <section id="guru-wali" class="content-section">
                <div class="section-title"><i class="ph ph-users-three"></i> Guru Wali</div>
                <div class="tab-nav no-print">
                    <button class="nav-btn active" onclick="switchTab(this, 'gw-daftar')">Daftar Siswa</button>
                    <button class="nav-btn" onclick="askPasswordForGWTabs(this, 'gw-mulai')">Mulai Bimbingan</button>
                    <button class="nav-btn" onclick="askPasswordForGWTabs(this, 'gw-data')">Data Bimbingan</button>
                </div>

                <div id="password-overlay-gw" class="modal-overlay">
                    <div class="modal-card">
                        <i class="ph ph-lock-key" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                        <h3>Akses Guru Wali</h3>
                        <input type="password" id="pw-gw" class="form-input password-input" placeholder="****">
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeModal('password-overlay-gw')">Batal</button>
                            <button class="btn btn-primary" onclick="checkPw('pw-gw', 'password-overlay-gw')">Buka</button>
                        </div>
                    </div>
                </div>

                <div id="gw-daftar" class="tab-pane">
                    <div class="card">
                        <h3><i class="ph ph-user-plus"></i> Input Data Siswa Bimbingan</h3>
                        <form id="form-gw-tambah">
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom:18px;">
                                <input type="text" id="gw-nama" class="form-input" placeholder="Nama Siswa" required>
                                <select id="gw-kelas" class="form-select" required>
                                    <option value="">Kelas</option>
                                    <option value="71">71</option><option value="72">72</option><option value="73">73</option>
                                    <option value="74">74</option><option value="75">75</option><option value="76">76</option>
                                </select>
                            </div>
                            <button type="button" class="btn btn-primary" onclick="askPasswordForGW()"><i class="ph ph-plus"></i> Tambah ke Daftar</button>
                        </form>
                    </div>
                    <div class="card">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                            <h3 style="margin:0;"><i class="ph ph-list-dashes"></i> Daftar Siswa Bimbingan</h3>
                            <button class="btn btn-secondary" style="padding:8px 12px; font-size:0.8rem;" onclick="loadBimbinganStudents()"><i class="ph ph-arrows-clockwise"></i></button>
                        </div>
                        <div id="gw-list-siswa" style="color: var(--text-muted);">Memuat data...</div>
                    </div>
                </div>

                <div id="gw-mulai" class="tab-pane hidden">
                    <div class="card">
                        <h3><i class="ph ph-chat-text"></i> Formulir Bimbingan</h3>
                        <form id="form-gw-bimbingan">
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                                <div class="form-group"><label class="form-label">Tanggal</label><input type="date" id="gw-tanggal" class="form-input" required></div>
                                <div class="form-group"><label class="form-label">Jam</label><input type="time" id="gw-jam" class="form-input" required></div>
                            </div>
                            <div class="form-group"><label class="form-label">Nama Siswa</label><select id="gw-nama-siswa" class="form-select" required><option value="">-- Pilih Siswa --</option></select></div>
                            <div class="form-group"><label class="form-label">Jenis Bimbingan</label><select id="gw-jenis" class="form-select" required><option value="">-- Pilih --</option><option value="Pendampingan Akademik">Pendampingan Akademik</option><option value="Pengembangan Kompetensi">Pengembangan Kompetensi</option><option value="Pembentukan Karakter">Pembentukan Karakter</option><option value="Masalah Pribadi">Masalah Pribadi</option></select></div>
                            <div class="form-group"><label class="form-label">Catatan</label><textarea id="gw-catatan" class="form-textarea" rows="3" required></textarea></div>
                            <div class="form-group"><label class="form-label">Status</label><select id="gw-status" class="form-select" required><option value="Selesai">Selesai</option><option value="Perlu Perhatian">Perlu Perhatian</option><option value="Tindak Lanjut">Tindak Lanjut</option></select></div>
                            <button type="submit" class="btn btn-primary"><i class="ph ph-check-circle"></i> Simpan</button>
                        </form>
                    </div>
                </div>

                <div id="gw-data" class="tab-pane hidden">
                    <div class="card no-print" style="text-align: right;"><button class="btn btn-secondary" onclick="loadRekap('Bimbingan', 'rekap-gw-body')"><i class="ph ph-arrows-clockwise"></i> Refresh</button></div>
                    <div id="rekap-gw-body" class="card"><p style="text-align: center; color: var(--text-muted);">Tekan refresh.</p></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Password Modal for Jadwal -->
    <div id="password-overlay-jadwal" class="modal-overlay">
        <div class="modal-card">
            <i class="ph ph-lock-key" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
            <h3>Akses Form Tambah Jadwal</h3>
            <input type="password" id="pw-jadwal" class="form-input password-input" placeholder="****">
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('password-overlay-jadwal')">Batal</button>
                <button class="btn btn-primary" onclick="checkPw('pw-jadwal', 'password-overlay-jadwal')">Buka</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal-overlay">
        <div class="modal-card">
            <i class="ph ph-warning-circle" style="font-size: 3rem; color: var(--warning); margin-bottom: 15px;"></i>
            <h3>Konfirmasi</h3>
            <p id="confirm-message" style="color: var(--text-muted); margin-bottom: 25px;">Yakin?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeConfirmModal(false)">Batal</button>
                <button class="btn btn-danger" id="confirm-btn-yes">Ya</button>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <script>
        // =======================================================
        // URL WEB APP SUDAH DIPASANG
        // =======================================================
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbySWSlrjXNOjGGmGbX-jPKm_7GG6AKJ4WCnOGDzIqGUiwbqxNcypikvngqldAHRoSf_IA/exec'; 
        
        const PASSWORD = "OmGuru25"; 

        let studentsCache = {}; 
        let bimbinganStudents = [];
        let bahanAjarList = JSON.parse(localStorage.getItem('bahanAjarList')) || [];
        let pendingJurnalTab = null;
        let pendingGWTab = null;
        let pendingNilaiTab = null; 
        let confirmCallback = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            document.getElementById('current-day').innerText = today.toLocaleDateString('id-ID', { weekday: 'long' });
            document.getElementById('current-date').innerText = today.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
            const isoDate = today.toISOString().split('T')[0];

            ['j-tanggal', 'n-tanggal', 'gw-tanggal'].forEach(id => { 
                if(document.getElementById(id)) document.getElementById(id).value = isoDate; 
            });
            
            if(document.getElementById('gw-jam')) {
                document.getElementById('gw-jam').value = `${String(today.getHours()).padStart(2, '0')}:${String(today.getMinutes()).padStart(2, '0')}`;
            }

            renderBahanAjarList();

            const tahunSelects = [document.getElementById('jadwal-tahun'), document.getElementById('tahun-filter')];
            tahunSelects.forEach(select => {
                if(select) {
                    for (let y = 2025; y <= 2045; y++) {
                        select.innerHTML += `<option value="${y}/${y+1}">${y}/${y+1}</option>`;
                    }
                }
            });

            generateCheckboxes('jam-jadwal-container', 'jadwal-jam');
            generateWaktuCheckboxes('container-jadwal-waktu', 'jadwal-waktu');
            generateCheckboxes('jam-jurnal-container', 'jam');

            loadBimbinganStudents();

            document.getElementById('confirm-btn-yes').addEventListener('click', () => closeConfirmModal(true));
        });

        function showConfirm(message, callback) {
            document.getElementById('confirm-message').innerText = message;
            document.getElementById('confirm-modal').classList.add('active');
            confirmCallback = callback;
        }

        function closeConfirmModal(result) {
            document.getElementById('confirm-modal').classList.remove('active');
            if (result && confirmCallback) confirmCallback();
            confirmCallback = null;
        }

        function generateCheckboxes(containerId, name) {
            const container = document.getElementById(containerId);
            if(!container) return;
            container.innerHTML = ''; 
            for(let i=1; i<=10; i++) {
                container.innerHTML += `<label class="jam-checkbox-label"><input type="checkbox" name="${name}" value="${i}"><span>Ke-${i}</span></label>`;
            }
        }

        function generateWaktuCheckboxes(containerId, name) {
            const container = document.getElementById(containerId);
            if(!container) return;
            const waktuOptions = ["07.15 - 07.55", "07.55 - 08.35", "08.35 - 09.15", "09.15 - 09.55", "09.55 - 10.20", "10.20 - 11.00", "11.00 - 11.40", "12.50 - 13.30", "13.30 - 14.10", "14.10 - 14.50"];
            container.innerHTML = '';
            waktuOptions.forEach(w => container.innerHTML += `<label class="jam-checkbox-label"><input type="checkbox" name="${name}" value="${w}"><span>${w}</span></label>`);
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            let icon = type === 'success' ? 'check-circle' : (type === 'info' ? 'info' : 'warning-circle');
            toast.innerHTML = `<div style="display:flex; align-items:center; gap:12px;"><i class="ph ph-${icon}" style="font-size:1.2rem;"></i><span>${message}</span></div>`;
            container.appendChild(toast);
            setTimeout(() => { 
                toast.style.animation = 'slideInRight 0.3s ease reverse forwards'; 
                setTimeout(() => toast.remove(), 300); 
            }, 3000);
        }

        function showSection(id, btn) {
            document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('nav .nav-btn').forEach(el => el.classList.remove('active'));
            if(btn) btn.classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });

            if(id === 'jurnal') {
                const rekapAbsenBtn = document.querySelector('#jurnal .tab-nav button[onclick*="absen-rekap"]');
                if(rekapAbsenBtn) switchTab(rekapAbsenBtn, 'absen-rekap');
                closeModal('password-overlay-jurnal');
            }
            if(id === 'buku-nilai') { 
                switchTab(document.querySelector('#buku-nilai .tab-nav button'), 'nilai-rekap'); 
                closeModal('password-overlay-nilai'); 
            }
            if(id === 'guru-wali') { 
                switchTab(document.querySelector('#guru-wali .tab-nav button'), 'gw-daftar'); 
                closeModal('password-overlay-gw'); 
                loadBimbinganStudents(); 
            }
            if(id === 'jadwal') loadScheduleData(); 
            if(id === 'bahan-ajar') renderBahanAjarList();
        }

        function switchTab(btn, tabId) {
            const parent = btn ? btn.parentElement : document.querySelector('.tab-nav');
            parent.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            const container = btn ? btn.closest('.content-section') : parent.closest('.content-section');
            container.querySelectorAll('.tab-pane').forEach(p => p.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            container.querySelectorAll('.modal-overlay').forEach(modal => modal.classList.remove('active'));
            if(tabId === 'nilai-rekap') { 
                document.getElementById('nilai-login-card').classList.remove('hidden'); 
                document.getElementById('nilai-rekap-body').classList.add('hidden'); 
            }
        }

        // Password Logic
        function askPasswordForJurnal(btn, tabId) { 
            pendingJurnalTab = { btn: btn, tabId: tabId }; 
            document.getElementById('pw-jurnal').value = ''; 
            document.getElementById('password-overlay-jurnal').classList.add('active'); 
            setTimeout(() => document.getElementById('pw-jurnal').focus(), 100); 
        }

        function askPasswordForNilai(btn, tabId) { 
            pendingNilaiTab = { btn: btn, tabId: tabId }; 
            document.getElementById('pw-nilai').value = ''; 
            document.getElementById('password-overlay-nilai').classList.add('active'); 
            setTimeout(() => document.getElementById('pw-nilai').focus(), 100); 
        }

        function askPasswordForGWTabs(btn, tabId) { 
            pendingGWTab = { btn: btn, tabId: tabId }; 
            document.getElementById('pw-gw').value = ''; 
            document.getElementById('password-overlay-gw').classList.add('active'); 
            setTimeout(() => document.getElementById('pw-gw').focus(), 100); 
        }

        function askPasswordForGW() { 
            if(!document.getElementById('gw-nama').value || !document.getElementById('gw-kelas').value) { 
                showToast("Isi Nama dan Kelas!", "error"); 
                return; 
            } 
            document.getElementById('pw-gw').value = ''; 
            document.getElementById('password-overlay-gw').classList.add('active'); 
            setTimeout(() => document.getElementById('pw-gw').focus(), 100); 
        }

        function openJadwalForm() { 
            document.getElementById('pw-jadwal').value = ''; 
            document.getElementById('password-overlay-jadwal').classList.add('active'); 
            setTimeout(() => document.getElementById('pw-jadwal').focus(), 100); 
        }

        function closeJadwalForm() { document.getElementById('jadwal-input-wrapper').classList.add('hidden'); }

        function openBahanForm() { 
            document.getElementById('pw-bahan').value = ''; 
            document.getElementById('password-overlay-bahan').classList.add('active'); 
            setTimeout(() => document.getElementById('pw-bahan').focus(), 100); 
        }

        function closeBahanForm() { document.getElementById('bahan-form-wrapper').classList.add('hidden'); }

        function closeModal(modalId) { document.getElementById(modalId).classList.remove('active'); }

        function checkPw(inputId, modalId) {
            if(document.getElementById(inputId).value === PASSWORD) {
                closeModal(modalId);
                if(modalId === 'password-overlay-jurnal' && pendingJurnalTab) { 
                    switchTab(pendingJurnalTab.btn, pendingJurnalTab.tabId); 
                    pendingJurnalTab = null; 
                }
                if(modalId === 'password-overlay-nilai' && pendingNilaiTab) { 
                    switchTab(pendingNilaiTab.btn, pendingNilaiTab.tabId); 
                    pendingNilaiTab = null; 
                }
                if(modalId === 'password-overlay-bahan') { 
                    document.getElementById('bahan-form-wrapper').classList.remove('hidden'); 
                }
                if(modalId === 'password-overlay-gw') { 
                    if(pendingGWTab) { 
                        switchTab(pendingGWTab.btn, pendingGWTab.tabId); 
                        pendingGWTab = null; 
                    } else { 
                        submitGWTambah(); 
                    } 
                }
                if(modalId === 'password-overlay-jadwal') { 
                    document.getElementById('jadwal-input-wrapper').classList.remove('hidden'); 
                }
                showToast("Akses Diberikan", "success");
            } else { 
                showToast("Password Salah!", "error"); 
                document.querySelector(`#${modalId} .modal-card`).style.animation = "shake 0.4s"; 
                setTimeout(() => document.querySelector(`#${modalId} .modal-card`).style.animation = "", 400); 
            }
        }

        const styleSheet = document.createElement("style");
        styleSheet.innerText = "@keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }";
        document.head.appendChild(styleSheet);

        function checkNIS() {
            const nisInput = document.getElementById('input-nis-siswa').value;
            if(!nisInput) { showToast("Masukkan NIS", "error"); return; }
            document.getElementById('nilai-rekap-body').innerHTML = '<p style="text-align:center;"><i class="ph ph-spinner ph-spin" style="font-size:1.5rem; color:var(--primary)"></i></p>';
            
            const url = WEB_APP_URL + '?action=getData&sheetName=Data_Nilai&nocache=' + new Date().getTime();
            
            fetch(url)
                .then(res => res.json())
                .then(response => {
                    const studentData = (response.data || []).filter(row => row[0].toString() === nisInput);
                    if(studentData.length > 0) {
                        document.getElementById('nilai-login-card').classList.add('hidden');
                        document.getElementById('nilai-rekap-body').classList.remove('hidden');
                        renderTableFromData(studentData, 'nilai-rekap-body', true);
                    } else { 
                        showToast("Data tidak ditemukan", "error"); 
                    }
                }).catch(err => showToast("Error", "error"));
        }

        function loadSiswa(selectId, targetId) {
            const kelas = document.getElementById(selectId).value;
            const div = document.getElementById(targetId);
            if(!kelas) return;
            div.innerHTML = '<p style="text-align:center; padding: 20px;"><i class="ph ph-spinner ph-spin"></i></p>';

            if (studentsCache[kelas] && studentsCache[kelas].length > 0) {
                 renderSiswaList(div, targetId, studentsCache[kelas]);
                 return;
            }

            const url = WEB_APP_URL + '?action=getData&sheetName=Data_Siswa&nocache=' + new Date().getTime();
            
            fetch(url)
                .then(res => res.json())
                .then(response => {
                    const flatData = response.data || [];
                    studentsCache = {}; 
                    if (flatData.length > 0) {
                        const headerRow = flatData[0];
                        let nameIdx = headerRow.findIndex(cell => String(cell).toUpperCase().trim() === "NAMA");
                        let classIdx = headerRow.findIndex(cell => String(cell).toUpperCase().trim() === "KELAS");
                        
                        if(nameIdx === -1) nameIdx = 2; 
                        if(classIdx === -1) classIdx = 3; 

                        for(let i = 1; i < flatData.length; i++) {
                            const row = flatData[i];
                            if(!row || row.length === 0) continue;
                            const nama = row[nameIdx];
                            let klsRaw = row[classIdx];
                            if (nama && klsRaw) {
                                let klsNormalized = String(klsRaw).replace(/\./g, '').replace(/\s/g, '').replace(/-/g, '');
                                if(!studentsCache[klsNormalized]) studentsCache[klsNormalized] = [];
                                studentsCache[klsNormalized].push({id: row[0] || i, NAMA: nama});
                            }
                        }
                    }
                    
                    if(studentsCache[kelas] && studentsCache[kelas].length > 0) {
                        renderSiswaList(div, targetId, studentsCache[kelas]);
                    } else {
                        div.innerHTML = `<p style="text-align:center; color:var(--danger); padding: 20px;">Data siswa kelas <b>${kelas}</b> tidak ditemukan di Spreadsheet.</p>`;
                    }
                }).catch(err => { 
                    console.error(err); 
                    div.innerHTML = '<p style="text-align:center; color:var(--danger);">Koneksi gagal.</p>'; 
                });
        }

        function renderSiswaList(div, targetId, data) {
            div.innerHTML = '';
            if(targetId === 'list-absen') {
                data.forEach((s) => {
                    div.innerHTML += `<div class="student-item"><div>${s.NAMA}</div><div class="status-group" data-name="${s.NAMA}"><button type="button" class="status-btn active-hadir" onclick="setAbsen(this, 'Hadir')">H</button><button type="button" class="status-btn" onclick="setAbsen(this, 'Sakit')">S</button><button type="button" class="status-btn" onclick="setAbsen(this, 'Izin')">I</button><button type="button" class="status-btn" onclick="setAbsen(this, 'Alpa')">A</button><button type="button" class="status-btn" onclick="setAbsen(this, 'Bolos')">B</button></div></div>`;
                });
            } else if (targetId === 'list-nilai') {
                data.forEach((s) => { 
                    div.innerHTML += `<div class="student-item"><div>${s.NAMA}</div><input type="number" class="form-input score-input" style="width:80px; margin-bottom:0; text-align:center; padding:8px;" data-name="${s.NAMA}" placeholder="0"></div>`; 
                });
            }
            div.innerHTML += `<div class="student-count-footer">Total: ${data.length} Siswa</div>`;
        }

        function setAbsen(btn, status) {
            const parent = btn.parentElement;
            parent.querySelectorAll('.status-btn').forEach(b => { b.className = 'status-btn'; });
            let cls = 'active-hadir'; 
            if(status === 'Sakit') cls = 'active-sakit'; 
            if(status === 'Izin') cls = 'active-izin'; 
            if(status === 'Alpa') cls = 'active-alpa'; 
            if(status === 'Bolos') cls = 'active-bolos';
            btn.classList.add(cls);
            parent.dataset.status = status;
        }

        // Form Submissions
        document.getElementById('form-jurnal').addEventListener('submit', (e) => {
            e.preventDefault();
            const btn = document.getElementById('btn-submit-jurnal'); 
            btn.disabled = true; 
            btn.innerHTML = '<i class="ph ph-spinner ph-spin"></i>';
            const jamValues = Array.from(document.querySelectorAll('input[name="jam"]:checked')).map(cb => cb.value).join(', ');
            const jurnalData = { 
                tanggal: document.getElementById('j-tanggal').value, 
                kelas: document.getElementById('j-kelas').value, 
                jamKe: jamValues, 
                materiPokok: document.getElementById('j-materi').value, 
                kegiatanPembelajaran: document.getElementById('j-kegiatan').value 
            };
            const absensiData = [];
            document.querySelectorAll('#list-absen .status-group').forEach(grp => { 
                absensiData.push({ 
                    tanggal: jurnalData.tanggal, 
                    kelas: jurnalData.kelas, 
                    jamKe: jurnalData.jamKe, 
                    namaSiswa: grp.dataset.name, 
                    status: grp.dataset.status || 'Hadir' 
                }); 
            });
            fetch(WEB_APP_URL, { 
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/json' }, 
                body: JSON.stringify({ action: 'submitJurnal', jurnal: jurnalData, absensi: absensiData }) 
            })
                .then(() => { 
                    showToast("Terkirim!"); 
                    btn.disabled = false; 
                    btn.innerHTML = '<i class="ph ph-paper-plane-right"></i> Kirim'; 
                    document.getElementById('form-jurnal').reset(); 
                    document.getElementById('list-absen').innerHTML = ''; 
                })
                .catch(err => { 
                    showToast("Gagal", "error"); 
                    btn.disabled = false; 
                    btn.innerHTML = '<i class="ph ph-paper-plane-right"></i> Kirim'; 
                });
        });

        document.getElementById('form-nilai').addEventListener('submit', (e) => {
            e.preventDefault();
            const btn = document.getElementById('btn-submit-nilai'); 
            btn.disabled = true; 
            btn.innerHTML = '<i class="ph ph-spinner ph-spin"></i>';
            const meta = { 
                tanggal: document.getElementById('n-tanggal').value, 
                kelas: document.getElementById('n-kelas').value, 
                jenis: document.getElementById('n-jenis').value, 
                materi: document.getElementById('n-materi').value 
            };
            const nilaiData = [];
            document.querySelectorAll('.score-input').forEach(input => { 
                if(input.value !== '') nilaiData.push({ namaSiswa: input.dataset.name, nilai: parseFloat(input.value) }); 
            });
            fetch(WEB_APP_URL, { 
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/json' }, 
                body: JSON.stringify({ action: 'submitNilai', ...meta, data: nilaiData }) 
            })
                .then(() => { 
                    showToast("Tersimpan!"); 
                    btn.disabled = false; 
                    btn.innerHTML = '<i class="ph ph-floppy-disk"></i> Simpan'; 
                    document.querySelectorAll('.score-input').forEach(i => i.value = ''); 
                })
                .catch(err => { 
                    showToast("Gagal", "error"); 
                    btn.disabled = false; 
                    btn.innerHTML = '<i class="ph ph-floppy-disk"></i> Simpan'; 
                });
        });

        // Guru Wali Logic
        function submitGWTambah() {
            const name = document.getElementById('gw-nama').value;
            const kelas = document.getElementById('gw-kelas').value;
            if(!name || !kelas) return;

            fetch(WEB_APP_URL, {
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'submitBimbinganMaster',
                    nama: name,
                    kelas: kelas,
                    tanggal: new Date().toISOString().split('T')[0]
                })
            }).then(() => {
                showToast(`${name} ditambahkan ke server.`);
                document.getElementById('form-gw-tambah').reset();
                loadBimbinganStudents();
            }).catch(err => showToast("Gagal menyimpan", "error"));
        }

        function loadBimbinganStudents() {
            const div = document.getElementById('gw-list-siswa');
            const select = document.getElementById('gw-nama-siswa');

            div.innerHTML = '<p style="text-align:center;"><i class="ph ph-spinner ph-spin"></i></p>';
            select.innerHTML = '<option value="">-- Memuat --</option>';

            const url = WEB_APP_URL + '?action=getData&sheetName=Data_Bimbingan&nocache=' + new Date().getTime();
            
            fetch(url)
                .then(res => res.json())
                .then(response => {
                    const data = response.data || [];
                    bimbinganStudents = [];

                    if(data.length > 0) {
                        const startRow = (String(data[0][0]).toUpperCase() === 'TIMESTAMP') ? 1 : 0;
                        const seen = new Set();

                        for(let i=startRow; i<data.length; i++) {
                            const row = data[i];
                            const nama = row[3]; 
                            const kls = row[4];  
                            if(nama && kls) {
                                const key = nama + "-" + kls;
                                if(!seen.has(key)) {
                                    bimbinganStudents.push({ name: nama, kelas: kls });
                                    seen.add(key);
                                }
                            }
                        }
                    }

                    div.innerHTML = '';
                    if(bimbinganStudents.length === 0) {
                        div.innerHTML = '<p style="text-align:center; color:var(--text-muted);">Belum ada siswa bimbingan.</p>';
                    } else {
                        bimbinganStudents.forEach((s) => {
                            div.innerHTML += `<div class="student-item"><div><strong>${s.name}</strong> <span style="font-size:0.8em; color:var(--text-muted);">(${s.kelas})</span></div></div>`;
                        });
                    }

                    select.innerHTML = '<option value="">-- Pilih Siswa Bimbingan --</option>';
                    bimbinganStudents.forEach(s => {
                        const opt = document.createElement('option');
                        opt.value = JSON.stringify(s);
                        opt.textContent = `${s.name} (${s.kelas})`;
                        select.appendChild(opt);
                    });
                }).catch(err => {
                    div.innerHTML = '<p style="text-align:center; color:var(--danger);">Gagal memuat data.</p>';
                });
        }

        document.getElementById('form-gw-bimbingan').addEventListener('submit', (e) => {
            e.preventDefault();
            const studentRaw = document.getElementById('gw-nama-siswa').value;
            if(!studentRaw) { showToast("Pilih siswa dulu!", "error"); return; }
            const studentObj = JSON.parse(studentRaw);
            const btn = e.target.querySelector('button[type="submit"]'); 
            btn.disabled = true; 
            btn.innerHTML = '<i class="ph ph-spinner ph-spin"></i>';

            fetch(WEB_APP_URL, {
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'submitBimbingan',
                    tanggal: document.getElementById('gw-tanggal').value,
                    jam: document.getElementById('gw-jam').value,
                    namaSiswa: studentObj.name,
                    kelas: studentObj.kelas,
                    jenis: document.getElementById('gw-jenis').value,
                    catatan: document.getElementById('gw-catatan').value,
                    status: document.getElementById('gw-status').value
                })
            }).then(() => {
                showToast('Tersimpan!');
                document.getElementById('form-gw-bimbingan').reset();
                const now = new Date();
                document.getElementById('gw-tanggal').valueAsDate = now;
                document.getElementById('gw-jam').value = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
                btn.disabled = false; 
                btn.innerHTML = '<i class="ph ph-check-circle"></i> Simpan';
            }).catch(err => { 
                showToast("Gagal", "error"); 
                btn.disabled = false; 
                btn.innerHTML = '<i class="ph ph-check-circle"></i> Simpan'; 
            });
        });

        // Bahan Ajar
        document.getElementById('form-bahan').addEventListener('submit', (e) => {
            e.preventDefault();
            const btn = document.getElementById('btn-submit-bahan'); 
            btn.disabled = true; 
            btn.innerHTML = '<i class="ph ph-spinner ph-spin"></i>';
            bahanAjarList.push({ 
                id: Date.now(), 
                judul: document.getElementById('ba-judul').value, 
                link: document.getElementById('ba-link').value, 
                desc: document.getElementById('ba-desc').value, 
                tanggal: new Date().toLocaleDateString('id-ID') 
            });
            localStorage.setItem('bahanAjarList', JSON.stringify(bahanAjarList));
            btn.disabled = false; 
            btn.innerHTML = '<i class="ph ph-upload"></i> Simpan';
            showToast("Tersimpan!"); 
            document.getElementById('form-bahan').reset(); 
            renderBahanAjarList();
        });

        function renderBahanAjarList() {
            const container = document.getElementById('list-bahan-container');
            if (bahanAjarList.length === 0) { 
                container.innerHTML = '<p style="color:var(--text-muted); grid-column: 1/-1; text-align:center;">Belum ada materi.</p>'; 
                return; 
            }
            container.innerHTML = '';
            bahanAjarList.forEach((item, index) => {
                container.innerHTML += `<div class="bahan-card"><button class="delete-btn" onclick="confirmDeleteBahan(${index})"><i class="ph ph-trash"></i></button><h4>${item.judul}</h4><p>${item.desc}</p><a href="${item.link}" target="_blank" class="btn btn-secondary" style="font-size:0.85rem;"><i class="ph ph-link"></i> Buka</a></div>`;
            });
        }

        function confirmDeleteBahan(index) { 
            showConfirm("Hapus materi?", () => { 
                bahanAjarList.splice(index, 1); 
                localStorage.setItem('bahanAjarList', JSON.stringify(bahanAjarList)); 
                renderBahanAjarList(); 
                showToast("Dihapus", "info"); 
            }); 
        }

        // Jadwal
        document.getElementById('form-jadwal').addEventListener('submit', (e) => {
            e.preventDefault();
            const btn = document.querySelector('#jadwal-input-wrapper button[type="submit"]'); 
            btn.disabled = true; 
            btn.innerHTML = '<i class="ph ph-spinner ph-spin"></i>';
            const jamValues = Array.from(document.querySelectorAll('input[name="jadwal-jam"]:checked')).map(cb => cb.value).join(', ');
            const waktuValues = Array.from(document.querySelectorAll('input[name="jadwal-waktu"]:checked')).map(cb => cb.value).join(', ');
            const jadwalData = { 
                tahun: document.getElementById('jadwal-tahun').value, 
                semester: document.getElementById('jadwal-semester').value, 
                hari: document.getElementById('jadwal-hari').value, 
                jamKe: jamValues, 
                waktu: waktuValues, 
                kelas: document.getElementById('jadwal-kelas').value, 
                mapel: document.getElementById('jadwal-mapel').value 
            };
            fetch(WEB_APP_URL, { 
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/json' }, 
                body: JSON.stringify({ action: 'addJadwal', data: jadwalData }) 
            })
                .then(() => { 
                    showToast("Tersimpan!"); 
                    btn.disabled = false; 
                    btn.innerHTML = '<i class="ph ph-floppy-disk"></i> Simpan'; 
                    document.getElementById('form-jadwal').reset(); 
                    loadScheduleData(); 
                })
                .catch(err => { 
                    showToast("Gagal", "error"); 
                    btn.disabled = false; 
                    btn.innerHTML = '<i class="ph ph-floppy-disk"></i> Simpan'; 
                });
        });

        function loadScheduleData() {
            const div = document.getElementById('jadwal-content');
            const filterTahun = document.getElementById('tahun-filter').value;
            const filterSem = document.getElementById('semester-filter').value;
            div.innerHTML = '<p style="text-align:center;"><i class="ph ph-spinner ph-spin"></i></p>';
            
            const url = WEB_APP_URL + '?action=getData&sheetName=Jadwal&nocache=' + new Date().getTime();
            
            fetch(url)
                .then(res => res.json())
                .then(response => {
                    let dataRows = (response.data && response.data[0] && response.data[0][0] === 'Timestamp') ? response.data.slice(1) : response.data || [];
                    const filteredRows = dataRows.filter(row => row[1] === filterTahun && row[2] === filterSem);
                    let html = `<div class="table-container"><table><thead><tr><th>Hari</th><th>Jam</th><th>Waktu</th><th>Kelas</th><th>Mapel</th></tr></thead><tbody>`;
                    filteredRows.forEach(r => { 
                        html += `<tr><td>${r[3]||'-'}</td><td>${r[4]||'-'}</td><td>${r[5]||'-'}</td><td>${r[6]||'-'}</td><td>${r[7]||'-'}</td></tr>`; 
                    });
                    html += `</tbody></table></div>`;
                    div.innerHTML = html;
                }).catch(err => { div.innerHTML = '<p style="text-align:center">Gagal.</p>'; });
        }

        function loadRekap(type, targetId) {
            const div = document.getElementById(targetId);
            div.innerHTML = '<p style="text-align:center;"><i class="ph ph-spinner ph-spin"></i></p>';
            
            const url = WEB_APP_URL + '?action=getData&sheetName=Data_' + type + '&nocache=' + new Date().getTime();
            
            fetch(url)
                .then(res => res.json())
                .then(response => {
                    if(response.data && response.data.length > 0) {
                        renderTableFromData(response.data, targetId);
                    } else {
                        div.innerHTML = '<p style="text-align:center; color:var(--text-muted)">Kosong.</p>';
                    }
                }).catch(err => { div.innerHTML = '<p style="text-align:center">Error.</p>'; });
        }

        function renderTableFromData(values, targetId, isStudentView = false) {
            const div = document.getElementById(targetId);
            if(!values || values.length === 0) { div.innerHTML = '<p>Kosong.</p>'; return; }
            let html = `<div class="table-container"><table><thead><tr>`;
            values[0].forEach(h => html += `<th>${h}</th>`);
            html += `</tr></thead><tbody>`;
            for (let i = 1; i < values.length; i++) { 
                html += `<tr>${values[i].map(cell => `<td>${cell}</td>`).join('')}</tr>`; 
            }
            html += `</tbody></table></div>`;
            if(isStudentView) {
                html += `<div style="margin-top:20px; text-align:center;"><button class="btn btn-secondary" onclick="document.getElementById('nilai-login-card').classList.remove('hidden'); document.getElementById('nilai-rekap-body').classList.add('hidden');">Kembali</button></div>`;
            }
            div.innerHTML = html;
        }
    </script>
</body>
</html>